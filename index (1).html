<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image to Matrix</title>
</head>
<body>

<input type="file" id="fileInput" accept="image/*">
<canvas id="canvas" style="display: none;"></canvas>

<div>
  <h2>Imagem Original</h2>
  <img id="originalImage">
</div>

<div>
  <h2>Imagem com Brilho Aumentado</h2>
  <img id="brightenedImage">
</div>

<div>
  <h2>Imagem em Escala de Cinza</h2>
  <img id="grayImage">
</div>

<div>
    <h2>Imagem Negative</h2>
    <img id="imgNegative">
</div>


<script>
function imageToMatrix(imageFile) {
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    const img = new Image();
    img.onload = function() {
        canvas.width = img.width;
        canvas.height = img.height;
        ctx.drawImage(img, 0, 0);

        const imageData = ctx.getImageData(0, 0, img.width, img.height);
        const pixels = imageData.data;
        const matrix = [];

        for (let i = 0; i < pixels.length; i += 4) {
            const red = pixels[i];
            const green = pixels[i + 1];
            const blue = pixels[i + 2];
            const alpha = pixels[i + 3];
            matrix.push([red, green, blue, alpha]);
        }
        
        const brightenedMatrix = brilho(matrix);
        const grayMatrix = gray(matrix);
        displayImages(img, brightenedMatrix, grayMatrix);
    };

    img.src = URL.createObjectURL(imageFile);
}

function brilho(matrix) {
    const brightenedMatrix = [];
    for (let i = 0; i < matrix.length; i++) {
        const pixel = matrix[i];
        const red = Math.min(pixel[0] + 50, 255);
        const green = Math.min(pixel[1] + 50, 255);
        const blue = Math.min(pixel[2] + 50, 255);
        const alpha = pixel[3];
        brightenedMatrix.push([red, green, blue, alpha]);
    }
    console.log(brightenedMatrix)
    return brightenedMatrix;
}

function negativo(matrix) {
    const negativeMatrix = [];
    for (let i = 0; i < matrix.length; i++) {
        const pixel = matrix[i];
        const red = Math.min(pixel[0] - 255, 255);
        const green = Math.min(pixel[1] - 255, 255);
        const blue = Math.min(pixel[2] - 255, 255);
        const alpha = pixel[3];
        negativeMatrix.push([red, green, blue, alpha]);
    }
    console.log(negativeMatrix)
    return negativeMatrix;
}


function gray(matrix){
    const grayMatrix = [];
    for (let i = 0; i < matrix.length; i++) {
        const pixel = matrix[i];
        const red = pixel[0];
        const green = pixel[1];
        const blue = pixel[2];

        // Calculo ponderado para escala de cinza
        const imgGray = (red * 0.3 + green * 0.59 + blue * 0.11);
        grayMatrix.push([imgGray, imgGray, imgGray, pixel[3]]);
    }
    return grayMatrix;
}

function displayImages(originalImg, brightenedMatrix, grayMatrix,negativeMatrix) {
    const canvas = document.createElement('canvas');
    canvas.width = originalImg.width;
    canvas.height = originalImg.height;
    const ctx = canvas.getContext('2d');

    const imageData = ctx.createImageData(originalImg.width, originalImg.height);
    const pixels = imageData.data;

    for (let i = 0; i < brightenedMatrix.length; i++) {
        const pixel = brightenedMatrix[i];
        pixels[i * 4] = pixel[0]; // red
        pixels[i * 4 + 1] = pixel[1]; // green
        pixels[i * 4 + 2] = pixel[2]; // blue
        pixels[i * 4 + 3] = pixel[3]; // alpha
    }

    ctx.putImageData(imageData, 0, 0);

    document.getElementById('originalImage').src = originalImg.src;
    document.getElementById('brightenedImage').src = canvas.toDataURL();

    // Exibir a imagem em escala de cinza
    const grayCanvas = document.createElement('canvas');
    grayCanvas.width = originalImg.width;
    grayCanvas.height = originalImg.height;
    const grayCtx = grayCanvas.getContext('2d');

    const grayImageData = grayCtx.createImageData(originalImg.width, originalImg.height);
    const grayPixels = grayImageData.data;

    for (let i = 0; i < grayMatrix.length; i++) {
        const pixel = grayMatrix[i];
        grayPixels[i * 4] = pixel[0]; // red
        grayPixels[i * 4 + 1] = pixel[1]; // green
        grayPixels[i * 4 + 2] = pixel[2]; // blue
        grayPixels[i * 4 + 3] = pixel[3]; // alpha
    }

    grayCtx.putImageData(grayImageData, 0, 0);
    document.getElementById('grayImage').src = grayCanvas.toDataURL();

    const negativeCanvas = document.createElement('canvas');
    negativeCanvas.width = originalImg.width;
    negativeCanvas.height = originalImg.height;
    const negativeCtx = negativeCanvas.getContext('2d');

    const negativeImageData = negativeCtx.createImageData(originalImg.width, originalImg.height);
    const negativePixels = negativeImageData.data;

    for (let i = 0; i < negativeMatrix.length; i++) {
        const pixel = negativeMatrix[i];
        negativePixels[i * 4] = pixel[0]; // red
        negativePixels[i * 4 + 1] = pixel[1]; // green
        negativePixels[i * 4 + 2] = pixel[2]; // blue
        negativePixels[i * 4 + 3] = pixel[3]; // alpha
    }

    negativeCtx.putImageData(negativeImageData, 0, 0);
    document.getElementById('imgNegative').src = negativeCanvas.toDataURL();
}

document.getElementById('fileInput').addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (file) {
        imageToMatrix(file);
    }
});
</script>

</body>
</html>
